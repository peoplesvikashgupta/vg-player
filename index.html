<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>VG Player</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/shaka-player/4.7.11/shaka-player.ui.min.js" crossorigin="anonymous"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/shaka-player/4.7.11/controls.min.css" crossorigin="anonymous">
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body, html { 
      background: #000; 
      height: 100%; width: 100%; 
      overflow: hidden; 
      font-family: 'Segoe UI', sans-serif; 
    }
    #setup-screen {
      position: fixed; inset: 0;
      background: #141414;
      display: flex; flex-direction: column;
      justify-content: center; align-items: center;
      z-index: 1000;
    }
    .setup-box {
      width: 90%; max-width: 420px; text-align: center;
      padding: 40px; background: #1a1a1a; border-radius: 15px;
      border: 1px solid #333; box-shadow: 0 10px 30px rgba(0,0,0,0.5);
    }
    h1 { color: #e50914; margin-bottom: 20px; font-weight: 900; letter-spacing: 2px; text-transform: uppercase; }
    input {
      width: 100%; padding: 14px; background: #000; border: 1px solid #e50914;
      border-radius: 6px; color: white; margin-bottom: 25px; outline: none; font-size: 1rem;
    }
    button#start-btn {
      width: 100%; padding: 14px; background: #e50914;
      color: white; border: none; border-radius: 6px;
      font-weight: 900; cursor: pointer; text-transform: uppercase; transition: 0.3s;
    }
    button#start-btn:hover { background: #b20710; }
    #player-wrapper { width: 100%; height: 100%; display: none; }
    video { width: 100%; height: 100%; object-fit: contain; }
    .shaka-video-container { width: 100%; height: 100%; }
    
    /* VG Style Controls */
    .shaka-range-container { background: #e50914 !important; }
    .shaka-volume-bar-container { background: #e50914 !important; }
  </style>
</head>
<body>

  <div id="setup-screen">
    <div class="setup-box">
      <h1>VG Player</h1>
      <input type="text" id="stream-url" placeholder="Paste your Link here...">
      <button id="start-btn" onclick="startVG()">Play Stream</button>
      <p style="color:#666; font-size:11px; margin-top:20px; font-weight:bold; letter-spacing:1px;">Created By Vikash Gupta</p>
    </div>
  </div>

  <div id="player-wrapper">
    <div id="video-container">
      <video autoplay playsinline id="video-canvas"></video>
    </div>
  </div>

  <script>
    let player;
    let ui;

    async function startVG() {
      let url = document.getElementById('stream-url').value.trim();
      
      if (!url) return alert("Please enter a URL");

      // --- THE FIX: AUTO-PROXY ---
      // If the link is HTTP (Insecure), we force it through a Secure Proxy.
      // This tricks GitHub/Browser into thinking it is a secure HTTPS link.
      if (url.startsWith('http://')) {
          console.log("Insecure HTTP detected. Adding Proxy...");
          url = 'https://corsproxy.io/?' + url;
      }

      // Hide Setup, Show Player
      document.getElementById('setup-screen').style.display = 'none';
      document.getElementById('player-wrapper').style.display = 'block';

      // Init Shaka Player
      shaka.polyfill.installAll();
      const video = document.getElementById('video-canvas');
      const container = document.getElementById('video-container');
      
      player = new shaka.Player(video);
      ui = new shaka.ui.Overlay(player, container, video);

      // UI Config
      ui.configure({
        'controlPanelElements': [
          'play_pause', 'time_and_duration', 'spacer', 'mute', 
          'volume', 'picture_in_picture', 'quality', 'fullscreen'
        ],
        'seekBarColors': { base: 'rgba(255, 255, 255, 0.2)', played: '#e50914' }
      });

      // Player Config
      player.configure({
        streaming: { lowLatencyMode: true, useNativeHlsOnSafari: true }
      });

      try {
        await player.load(url);
        console.log("Video loaded successfully");
      } catch (e) {
        console.error("Error code", e.code, "object", e);
        alert("Error: Link blocked or offline. Try a different stream.");
        location.reload();
      }
    }
  </script>
</body>
</html>
